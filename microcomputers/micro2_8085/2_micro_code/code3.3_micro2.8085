START:
	IN 10H		
	LXI H,0A00H
	MVI B,04H	; Για την παρακάτω επανάληψη

L1:	              ; αποθήκευση κενού x4 
	MVI M,10H	
	INX H
	DCR B
	JNZ L1
	
; Γραμμή 0
	MVI A,FEH	; πόρτα σάρωσης = 11111110 
	STA 2800H	
	LDA 1800H	; διάβασμα στηλών των πλήκτρων 
	ANI 07H	; κρατάμε μόνο τα 3 LSB, αυτά μας ενδιαφέρουν για την στήλη	

	MVI C,86H	; πιθανό κουμπί
	CPI 06H	; έλεγχος
	JZ SHOW	; αν ναι τύπωσέ το στο 7-segment display

	MVI C,85H	; ομοίως για όλα τα πιθανά κουμπιά 
	CPI 05H	
	JZ SHOW	 	

; ομοίως και για τις υπόλοιπες γραμμές
; Γραμμή 1
	MVI A,FDH
	STA 2800H	
	LDA 1800H	 
	ANI 07H		

	MVI C,84H	
	CPI 06H	; RUN	
	JZ SHOW	
	MVI C,80H	
	CPI 05H	; FETCH_REG
	JZ SHOW	 
	MVI C,82H	 
	CPI 03H	; FETCH_ADDRS
	JZ SHOW

; Γραμμή 2
	MVI A,FBH
	STA 2800H	
	LDA 1800H	 
	ANI 07H		

	MVI C,00H	
	CPI 06H	; 0
	JZ SHOW	
	MVI C,83H	
	CPI 05H	; STORE/INCR
	JZ SHOW	 
	MVI C,81H	 
	CPI 03H	; DECR
	JZ SHOW

; Γραμμή 3
	MVI A,F7H
	STA 2800H	
	LDA 1800H	 
	ANI 07H		

	MVI C,01H	; 1
	CPI 06H	
	JZ SHOW	
	MVI C,02H	; 2
	CPI 05H	
	JZ SHOW	 
	MVI C,03H	; 3
	CPI 03H	
	JZ SHOW

; Γραμμή 4
	MVI A,EFH
	STA 2800H	
	LDA 1800H	 
	ANI 07H		

	MVI C,04H
	CPI 06H	; 4
	JZ SHOW
	MVI C,05H
	CPI 05H	; 5
	JZ SHOW
	MVI C,06H
	CPI 03H	; 6
	JZ SHOW

; Γραμμή 5
	MVI A,DFH
	STA 2800H	
	LDA 1800H	 
	ANI 07H		

	MVI C,07H
	CPI 06H	; 7
	JZ SHOW
	MVI C,08H
	CPI 05H	; 8
	JZ SHOW
	MVI C,09H
	CPI 03H	; 9
	JZ SHOW
; Γραμμή 6
	MVI A,BFH
	STA 2800H	
	LDA 1800H	 
	ANI 07H		

	MVI C,0AH
	CPI 06H	; A
	JZ SHOW
	MVI C,0BH
	CPI 05H	; B
	JZ SHOW
	MVI C,0CH
	CPI 03H	; C
	JZ SHOW

; Γραμμή 7
	MVI A,7FH
	STA 2800H	
	LDA 1800H	 
	ANI 07H		

	MVI C,0DH
	CPI 06H	; D
	JZ SHOW
	MVI C,0EH
	CPI 05H	; E
	JZ SHOW
	MVI C,0FH
	CPI 03H	; F
	JZ SHOW

	JMP START	; αν δεν πατήθηκε κουμπί, κάνουμε τους ελέγχους από την αρχή

; Εμφάνιση στο 7-segment display
SHOW:	
	LXI H,0A04H		
	MOV A,C		; (A) <- πληροφορία κουμπιού
	ANI 0FH		; απομόνωση 4 LSBs 
	MOV M,A		; μετακίνηση στο πέμπτο ψηφίο των 7-segment display

	INX H			; επόμενη θέση μνήμης
	MOV A,C		
	ANI F0H		; κρατάμε τα 4 MSBs
	RLC                 ; Μετατροπή σε 4 LSBs
	RLC		
	RLC
	RLC
	
	MOV M,A		; μετακίνηση στο έκτο ψηφίο του 7-segment display
	LXI D,0A00H		; μετακίνηση του block 0A00H - 0A05H
				; στο σημείο που διαβάζει η ρουτίνα DCD
	CALL STDM	
	CALL DCD		; ρουτίνα που εμφανίζει το αποτέλεσμα στο 7-segment display

	JMP START		; Ξανά από την αρχή

END